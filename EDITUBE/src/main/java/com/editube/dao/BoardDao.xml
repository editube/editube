<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.editube.dao.BoardDao">
	
	<select id="getUList" parameterType="HashMap"
		resultType="com.editube.dto.UBoardDto">
		<![CDATA[
		SELECT * FROM UBLIST_1
		WHERE RONUM >= (${pageNum}*${cnt})-(${cnt}-1)
			AND RONUM <= ${pageNum}*${cnt}
		]]>
	</select>
	
	<select id="getTList" parameterType="HashMap"
		resultType="com.editube.dto.UBoardDto">
		<![CDATA[
		SELECT * FROM UBLIST_1
		WHERE RONUM >= (${pageNum}*${cnt})-(${cnt}-1)
			AND RONUM <= ${pageNum}*${cnt}
		]]>
	</select>
	
	<select id="getDList" parameterType="HashMap"
		resultType="com.editube.dto.UBoardDto">
		<![CDATA[
		SELECT * FROM UBLIST_2
		WHERE RONUM >= (${pageNum}*${cnt})-(${cnt}-1)
			AND RONUM <= ${pageNum}*${cnt}
		]]>
	</select>
	
	<select id="getUTBoardCount" resultType="Integer">
		SELECT COUNT(*) FROM UBLIST_1
	</select>
	<select id="getUDBoardCount" resultType="Integer">
		SELECT COUNT(*) FROM UBLIST_2
	</select>
	
	<update id="viewUpdate" parameterType="Integer">
		UPDATE UB SET UB_VIEW = UB_VIEW+1
		WHERE UB_NUM = #{ubnum}
	</update>
	
	<select id="getUContent" parameterType="Integer"
		resultType="com.editube.dto.UBoardDto">
		SELECT * FROM UBLIST_1
		WHERE UBNUM = #{ubnum}
	</select>
	<select id="getUTContent" parameterType="Integer"
		resultType="com.editube.dto.UBoardDto">
		SELECT * FROM UBLIST_1
		WHERE UBNUM = #{ubnum}
	</select>
	<select id="getUDContent" parameterType="Integer"
		resultType="com.editube.dto.UBoardDto">
		SELECT * FROM UBLIST_2
		WHERE UBNUM = #{ubnum}
	</select>


	<insert id="uboardInsert" 
		parameterType="com.editube.dto.UBoardDto"
		useGeneratedKeys="true"
		keyProperty="ubnum">
		<selectKey keyProperty="ubnum"
			resultType="int" order="BEFORE">
			SELECT UBOARD_SEQ.NEXTVAL FROM DUAL
		</selectKey>
		INSERT INTO UB
		VALUES(${ubnum},#{ubnickname},#{ubcontent},#{ubtitle},DEFAULT,#{ubdeadline},#{ubstatus},#{ubpositiontype},#{ubcost},DEFAULT)
	</insert>
	
	<update id="boardUpdate" 
		parameterType="com.editube.dto.UBoardDto">
		UPDATE UB SET 
			UB_CONTENT=#{ubcontent},
			UB_TITLE=#{ubtitle},
			UB_DEADLINE=#{ubdeadline},
			UB_STATUS=#{ubstatus},
			UB_POSITIONTYPE=#{ubpositiontype},
			UB_COST=#{ubcost}
 		WHERE UB_NUM=#{ubnum}
	</update>
	
	<delete id="boardUDelete" parameterType="Integer">
		DELETE FROM UB WHERE
		UB_NUM=#{ubnum}
	</delete>
	
	<select id="getCList" parameterType="HashMap" resultType="com.editube.dto.ChatbotDto">
		SELECT * FROM CHATBOT WHERE (CH_MNICKNAME=#{nickname} AND CH_TARGETNICKNAME=#{targetnickname})
		OR (CH_MNICKNAME=#{targetnickname} AND CH_TARGETNICKNAME=#{nickname})
		ORDER BY ch_date
	</select>
	
	
	<insert id="chatInsert" parameterType="com.editube.dto.ChatbotDto">
		INSERT INTO CHATBOT VALUES (CHATBOT_SEQ.nextval,#{ch_mnickname},#{ch_content},#{ch_targetnickname},SYSDATE)
	</insert>
	
	<select id="chkReq" parameterType="Integer" resultType="com.editube.dto.RequestDto">
		SELECT * FROM REQUEST WHERE rq_bnum = #{ubnum}
	</select>
</mapper>






